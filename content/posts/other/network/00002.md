---
title: ネットワーク基礎
date: 2018-11-07T09:30:00+09:00
showDate: true
tags: ["network"]
---

---

# Macアドレス
- ネットワーク部品に割り当てられたアドレス
- 48ビットのアドレス
- 先頭24ビットは、部品メーカーの識別番号
- 後半24ビットは、TODO
- 16進数表記
- OSIの第2層のデータリンク層

---

# OSI
## OSI参照モデル
### レイヤー7:アプリケーション層
- アプリケーションに特化したプロトコルを規定
- HTTP
- メール送信のSMTP

### レイヤー6:プレゼンテーション層
- データの表現形式を規定
- データ保存形式、圧縮、文字コード

### レイヤー5:セッション層
- コネクション確立、データ転送のタイミングを規定

### レイヤー4:トランスポート層
- データ転送の制御を規定
- TCP/IP

### レイヤー3:ネットワーク層
- IPアドレス
- 異なるネットワークへデータを転送するルーティングの制御
- ルーター、レイヤー3スイッチ
- パケットをどこからどこに転送するかの情報＝ルーティングテーブルを管理

### レイヤー2:データリンク層
- MACアドレスによるデータ転送
- 同じネットワーク内（同一セグメント内）にあるノード間の通信を規定する
- レイヤー2スイッチ
- 通信したいノードがどのポートに繋がっているかをMACアドレスによって判断してパケットを転送している

### レイヤー1:物理層
- ケーブルやコネクタの形状を規定
- 100BASE-T(イーサネット)

## ファイヤーウォール
### パケットフィルタ
- IPアドレス、ポート番号を元にフィルタリング
  - 80(http), 443(https)のみパケットの通過を許可
- パケットフィルタリングのルールのことをACL

### アプリケーションゲートウェイ
- プロキシのこと

---

# Linux基礎
## Linux
- メモリ上に展開してプログラムをプロセス（PID）
- ハードディスに割り当てる仮想メモリのことをスワップ

### FHS（ディレクトリ構成）
- /bin
  - 基本コマンドを格納したディレクトリ
- /boot
  - OS起動に必要なファイルを格納したディレクトリ、vmlinuzがLinuxカーネルの正体
- /dev
  - デバイスを格納したディレクトリ、dev/nullは、何もないを表す
- /etc
  - OSやアプリケーションの設定ファイルを格納したディレクトリ、Webサーバを起動するHttpデーモンの設定など
- /home
  - ユーザを格納したディレクトリ
- /proc
  - カーネルやプロセス情報を格納したディレクトリ
- /sbin
  - システム管理用コマンドを格納したディレクトリ、reboot,mount、usr/sibn、usr/local/sbinにも配置される
- /tmp
  - 一時ファイルを格納したディレクトリ
- /usr
  - アプリケーションを格納したディレクトリ
- /var
  - ログとかを格納したディレクトリ

---

# ドメイン
## ドメイン名
- インターネット上のネットワークを一意に識別するための名称  
  ex.) 違うマンションなのに住所が一緒だと困る
- http://www. **hoge.co.jp**  // 太字部分が該当

## ホスト名
- インターネット上のネットワークのホストを一意に識別するための名称  
  ex.） 同じマンションで部屋番号が一緒だと困る
- http:// **www** .hoge.co.jp // 太字部分が該当

## FQDN(Fully Qualified Domain Name)=完全修飾ドメイン名
- ドメイン名とホスト名を繋げた文字列のこと
- http:// **www.hoge.co.jp** // 太字部分が該当

## サブドメイン
- `http://example.com/`をルートドメインとした場合
  - サブドメイン: `http://sub.example.com/`
  - サブディレクトリ: `http://example.com/sub/`

### 用途
- サブドメインは、テーマをより詳細に掘り下げる場合に作成される
- サブディレクトリは、テーマが分類されていたり役割が異なっていたりする場合に使用される

## ドメインの分類
`hoge.co.jp`

- jp : トップレベルドメイン
- co : セカンドレベルドメイン
- hoge : サードレベルドメイン

### トップレベルドメイン
#### gTLD
- 分野別トップレベルドメイン
- 利用者の居住国に関係なく誰でも取得できるドメイン

代表的なドメインの種類

| ドメインの種類 | 特徴・用途 |
|---|---|
| com | 企業・商用サービスを対象としたドメイン (commercialの略) |
| net | ネットワークサービスの提供者を対象としたドメイン (networkの略) |
| org | 非営利団体を対象としたドメイン |
| biz | ビジネスを目的で利用されるドメイン |
| info | 主に情報の提供者（情報サイト）を対象としたドメイン (information) |

#### ccTLD
- 国別トップレベルドメイン
- 国ごと、地域ごとに割り当てられたドメイン
- 原則として、その国・地域に存在する個人（団体）でないと取得できない
- 日本では`jp`が、ccTLDに該当する

| ドメインの種類 | 特徴・用途 |
|---|---|
| jp | 企業・商用サービスを対象としたドメイン (commercialの略) |
| cn | 中国 |
| gb | イギリス |
| en | ヨーロッパ連合 |
| ru | ロシア |


#### 属性別JPドメイン
- ccTLDの`jp`ドメインの中で、セカンドレベルドメインに指定の文字列が入り、その文字列ごとに取得可能な組織が限定されているドメイン
- ネットワークサービスを示す`ne.jp`を除き、1組織1つしか取得できない決まりとなっている
- 個人が属性別ドメインJPドメインを取得することはできない

| ドメインの種類 | 特徴・用途 |
|---|---|
| co.jp | 日本国内に登記のある会社・企業 (例：株式会社、有限会社、合名会社、合資会社、相互会社、特殊会社) |
| or.jp | 特定の法人組織 (例：財団法人、社団法人、医療法人、監査法人、宗教法人、特殊法人、協同組合) |
| ac.jp | 学校教育法等で認められた学校 (例：大学、大学校、高等専門学校、学校法人、職業訓練校) |
| go.jp | 日本国の政府機関、各省庁が管轄する研究所、特殊法人（特殊会社を除く） |
| ne.jp | ネットワークサービスごとに登録可能 |

## 独自ドメインとサブドメインの違い
### 独自ドメイン
- お名前.comのようなドメイン登録サービスで取得できるオリジナルドメインのこと
- 未使用のドメインである場合、ユーザ自身が希望するドメイン名を取得することができる
- 独自ドメインの取得は、取得および更新の際に費用が発生することがある

### サブドメイン
- 独自ドメインをさらに分割して利用できるドメインのこと
- 1つのドメインを目的別や用途別に分けて利用する際に使用される
- 独自ドメインを取得するとサブドメインを作成することができる
- 独自ドメインの前に`.`(ドット)で区切った任意の文字列を挿入して使用する
- サブドメインの数量の制限はサービス事業者によって異なる
- 複数サイト（またはサービス）を運営する際に用いられることが多い

`yahoo`の例

| サービス名 | URL | ドメイン名 |
|---|---|---|
| Yahoo! JAPAN | https://www.yahoo.co.jp | yahoo.co.jp |
| Yahoo!ショッピング | https://shopping.yahoo.co.jp | shppping.yahoo.co.jp |
| ヤフオク | https://auctions.yahoo.co.jp | auctions.yahoo.co.jp |
| Yahoo!天気 | https://weather.yahoo.co.jp | weather.yahoo.co.jp |
| Yahoo!ニュース | https://news.yahoo.co.jp | news.yahoo.co.jp |

`Jimdo`、`wix`などでは無料版で作成したホームページの場合、サブドメインとして登録される

| - | 無料版で作成できるURLの形式 |
|---|---|
| Jimdo | https://XXX.jimdofree.com |
| wix | https://XXX.wixsite.com |

## ドメイン名の

---

# DNS
- Domain Name System
- ドメイン名をIPアドレスに変換するシステム
- DNSサーバ
  - フルサービスリゾルバ（DNSキャッシュサーバ）
  - 権威DNSサーバ（DNSコンテンツサーバ）

## DNSレコード
### Aレコード
- Adress Record
- ドメインをIPアドレスに置き換えるレコード
- 例）`hoge.com. IN A 192.168.0.1`

### MXレコード
- Mail Exchange
- メールサーバのホスト名を記載するレコード
- ドメインに紐づいたメールを使用する場合には不可欠
- 例）`hoge.com. IN MX 10 mail.hoge.com`
  - 数字の10は優先度を意味している
  - 1つ目は10、2つ目は20、３つ目は....
  - 10ずつ増やしているのは、間に余裕を持たせているため!?
  - `XX@hoge.com`というメールアドレスは、`mail.hoge.com`が処理(配送)する

### CNAMEレコード
- Canonical NAME
- ドメインを別のドメインに置き換えるレコード
- 特定のドメインを別のドメインに転送する場合に使用する
- 例）`www`有り無しの場合で同じIPアドレスにアクセスする場合
```
hoge.com. IN A 192.168.0.1
www.hoge.com. IN CNAME hoge.com.
```

### TXTレコード
- TEXT

## DNSラウンドロビン
- ドメイン名とIPアドレスを 1:n で対応付けること
- hoge.co.jp = 192.168.1.1, 192.168.1.2, 192.168.1.3
- ドメインへのアクセス時には、n のサーバへ負荷分散される
- RFC3484

## NSレコード
- 権威DNSサーバが使うゾーンファイルの中身
- 管理を委託しているDNSサーバ名が記載されている

```
example.com IN NS ns1.example.com
```

---

# IP アドレス
（参考）
- https://qiita.com/mogulla3/items/efb4c9328d82d24d98e6

## グローバルIPアドレス
- 世界的には、ICANNが管理、日本では、JPNICが管理

## プライベートIPアドレス
- グローバルIPアドレスに変換せずにネットワーク接続を試みた場合、ルーター側でパケットの破棄が行われ、接続できない事象になる。

| CLASS | RANGE |
|---|---|
| クラスA | 10.0.0.0 ～ 10.255.255.255 |
| クラスB | 172.16.0.0 ～ 172.31.255.255 |
| クラスC | 192.168.0.0 ～ 192.168.255.255 |
