---
title: 
date: 2018-11-07T13:40:00+09:00
showDate: true
tags: ["elasticsearch"]
---

# 環境構築リスト
- [ローカル(Mac OSX) + Elasticsearch](#ローカルMac+Elasticsearch)
- [ローカル(Mac OSX) + docker](#ローカル(MacOSX)+docker)
- [EC2 + docker + Elasticsearch](#EC2+docker+Elasticsearch)
- [EC2 + docker + Elasticsearch by terraform](#EC2+docker+Elasticsearch+terraform)

# ローカルMac+Elasticsearch

## Java8 インストール
```
$ brew cask install homebrew/cask-versions/java8
``` 

## Elasticsearch インストール
```
$ brew install elasticsearch
```

## kibana インストール
```
$ brew install kibana
```

## 起動&アクセス
- elasticsearch
```
$ elasticsearch
```
- http://localhost:9200/
- 以下の画面が表示される
```
{
  "name" : "J5lEKmN",
  "cluster_name" : "elasticsearch_j_tsuchiya",
  "cluster_uuid" : "N9ufUy6hRGaXsbAqICbPRQ",
  "version" : {
    "number" : "6.4.3",
    "build_flavor" : "oss",
    "build_type" : "tar",
    "build_hash" : "fe40335",
    "build_date" : "2018-10-30T23:17:19.084789Z",
    "build_snapshot" : false,
    "lucene_version" : "7.4.0",
    "minimum_wire_compatibility_version" : "5.6.0",
    "minimum_index_compatibility_version" : "5.0.0"
  },
  "tagline" : "You Know, for Search"
}
```

- kibana
```
$ kibana
```
- http://localhost:5601/app/kibana

# ローカル(MacOSX)+docker
- dockerはインストール済み前提

## docker pull Elasticsearch
```
$ docker pull docker.elastic.co/elasticsearch/elasticsearch:6.2.1
```
## 起動
```
$ docker run -d -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" docker.elastic.co/elasticsearch/elasticsearch:6.2.1
$ docker ps
```
- http://localhost:9200/

# EC2+Docker+Elasticsearch
## docker インストール
```
$ sudo yum update

# docker インストール
$ sudo yum install -y docker

# docker 起動
$ sudo service docker start

# ec2-user を docker グループに追加する
$ sudo usermod -a -G docker ec2-user
$ cat /etc/group |grep docker
docker:x:497:ec2-user

# docker コマンドが使えるか確認する
$ docker info
```

## docker-compose インストール
```
# 公式の通り、curlでダウンロード
$ sudo curl -L "https://github.com/docker/compose/releases/download/1.23.1/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose

# バイナリに実行権限を付与する
$ sudo chmod +x /usr/local/bin/docker-compose

# インストールされたか確認する
$ docker-compose --version
docker-compose version 1.23.1, build b02f1306
```

## Elasticsearch環境の構築
todo

# EC2+docker+Elasticsearch+terraform
